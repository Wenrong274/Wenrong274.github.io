<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>C# on Wenrong Nexus</title>
    <link>https://wenrong-nexus.com/tags/c</link>
    <description>Recent content in C# on Wenrong Nexus</description>
    <generator>Hugo -- 0.124.1</generator>
    <language>zh</language>
    <lastBuildDate>Thu, 22 Aug 2024 21:28:59 +0800</lastBuildDate>
    <atom:link href="https://wenrong-nexus.com/tags/c" rel="self" type="application/rss+xml" />
    <item>
      <title>Effective C# 做法 04-06</title>
      <link>https://wenrong-nexus.com/posts/effectivecsharpitme04-06/</link>
      <pubDate>Thu, 22 Aug 2024 21:28:59 +0800</pubDate>
      <guid>https://wenrong-nexus.com/posts/effectivecsharpitme04-06/</guid>
      <description>Effective C# 做法 04-06 心得</description>
      <content:encoded><![CDATA[<h2 id="做法-04">做法 04</h2>
<p><code>以內插字串取代 string.Format()</code></p>
<p>推薦這樣寫</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Csharp" data-lang="Csharp"><span style="display:flex;"><span><span style="color:#66d9ef">string</span> name = <span style="color:#e6db74">&#34;test&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">float</span> height = <span style="color:#ae81ff">180</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> age = <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">string</span> str = <span style="color:#e6db74">$&#34;userName: {name}, age: {age}, height: {height}&#34;</span>;
</span></span></code></pre></div><h3 id="1-為什麼-mathpi-不寫-tostring-會造成-box-呢">1. 為什麼 Math.PI 不寫 ToString 會造成 box 呢?</h3>
<p>當需要調用 ToString() 方法時，如果我們沒有顯式調用，編譯器會嘗試使用 Object.ToString()。但是，為了使用 Object 上的方法，值類型必須先轉換為 Object，這就導致了裝箱。</p>
<h2 id="做法-05">做法 05</h2>
<p><code>對文化特定字串偏好 FormattableString</code></p>
<p>推薦使用 <code>FormattableString</code>，不會因為當地時間顯示或者數字的顯示有所差異。double 的小數點會是＂.＂；如果再歐洲會是顯示＂,＂。</p>
<h2 id="做法-06">做法 06</h2>
<p><code>避免字串型別 API</code></p>
<p>使用 <code>nameof</code> 運算子時，任何對於屬性名稱的改變都會正確的反應在用於事件參數的字串中。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Csharp" data-lang="Csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> Name
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">get</span> { <span style="color:#66d9ef">return</span> name; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">set</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">value</span> != name)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            name = <span style="color:#66d9ef">value</span>;
</span></span><span style="display:flex;"><span>            PropertyChanged?.Invoke(<span style="color:#66d9ef">this</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> PropertyChangedEventArgs(nameof(Name)));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
]]></content:encoded>
    </item>
    <item>
      <title>Effective C# 做法 01-03</title>
      <link>https://wenrong-nexus.com/posts/effectivecsharpitme01-03/</link>
      <pubDate>Sat, 17 Aug 2024 23:09:29 +0800</pubDate>
      <guid>https://wenrong-nexus.com/posts/effectivecsharpitme01-03/</guid>
      <description>Effective C# 做法 01-03 心得</description>
      <content:encoded><![CDATA[<h2 id="做法-01">做法 01</h2>
<p><code>偏好隱含型別的區域變數</code></p>
<p>參考書籍提到的最後一段</p>
<blockquote>
<p>簡單說，除非開者（包括以後的你）必須看到型別宣告才能理解程式，否則就使用 var 宣告區域變數。這個做法的標題是＂偏好＂而不是＂總是＂。我建議明確的宣告所有數值型別（int、float、double 與其他）而不要使用 var 宣告。其他東西就是用 var。多打幾個字 - 明確的宣告型別 - 不會提升行別安全或改善可讀性。如果挑錯宣告型別，你可能會造成編譯器本來能夠避免的低效率。</p>
</blockquote>
<h2 id="做法-02">做法 02</h2>
<p><code>偏好 readonly 而非 const</code></p>
<blockquote>
<p>必須在編譯期確定的值必須使用 const：屬性參數、switch case 標籤與 enum 定義，以及少數部會在版本間變化的數值。其餘狀況則傾向以 readonly 常數提升彈性。</p>
</blockquote>
<h3 id="1-const-使用建議">1. const 使用建議</h3>
<ul>
<li>對於在編譯時就能確定且永不改變的值</li>
<li>適用於基本數據類型（int、float、bool 等）和字符串</li>
<li>效能略優於 readonly，因為它是編譯時常量</li>
</ul>
<h3 id="2-readonly-使用建議">2. readonly 使用建議</h3>
<ul>
<li>對於運行時才能確定值的情況</li>
<li>可用於任何數據類型，包括引用類型和複雜類型</li>
<li>允許在構造函數中賦值</li>
</ul>
<h3 id="選擇指南">選擇指南</h3>
<ul>
<li>如果值在編譯時就能確定，且是基本類型或字符串，優先使用 const。</li>
<li>如果是引用類型或需要在運行時計算的值，使用 readonly。</li>
<li>如果需要在不同的構造函數中賦予不同的值，使用 readonly。</li>
<li>對於靜態成員，如果符合 const 的條件，優先使用 const；否則使用 static readonly。</li>
</ul>
<h2 id="做法-03">做法 03</h2>
<p><code>偏好 is 或 as 運算子而非型別轉換</code></p>
<p>推薦這樣寫</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Csharp" data-lang="Csharp"><span style="display:flex;"><span><span style="color:#66d9ef">object</span> o = <span style="color:#66d9ef">new</span> MyType();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// 不推薦</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> t = (MyType)o;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/// 推薦</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (o <span style="color:#66d9ef">is</span> MyType myType)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    myType.Do();
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/// do samething ...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
]]></content:encoded>
    </item>
  </channel>
</rss>
